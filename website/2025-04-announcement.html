<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Announcing generate-jsdoc-example-tests v0.1.0</title>
    <link rel="stylesheet" href="./styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/themes/prism-tomorrow.min.css"
        integrity="sha512-kSwGoyIkfz4+hMo5jkJngSByil9jxJPKbweYec/UgS+S1EgE45qm4Gea7Ks2oxQ7qiYyyZRn66A9df2lMtjIsw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script data-goatcounter="https://sacdenoeuds.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>

    <link rel="icon" type="image/svg+xml" href="./tada.svg" />
</head>

<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/prism.min.js"
        integrity="sha512-UOoJElONeUNzQbbKQbjldDf9MwOHqxNz49NNJJ1d90yp+X9edsHyJoAs6O4K19CZGaIdjI5ohK+O2y5lBTW6uQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/components/prism-typescript.min.js"
        integrity="sha512-Hb168WC7SiCJ1GlGPHBb5ol0ResC6n5wu+5V8FTT5inC5ajLgBSm2hpQBvDq1YG2KqXr7UanlfQqRy6VEb1/kQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/components/prism-bash.min.js"
        integrity="sha512-35RBtvuCKWANuRid6RXP2gYm4D5RMieVL/xbp6KiMXlIqgNrI7XRUh9HurE8lKHW4aRpC0TZU3ZfqG8qmQ35zA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <main>
        <section>
            <h1>Introducing generate-jsdoc-example-tests v0.1.0&nbsp;ðŸŽ‰</h1>
            <p>
                <a style="display: flex; align-items: center; gap: 1rem"
                    href="https://github.com/SacDeNoeuds/generate-jsdoc-example-tests" target="_blank"
                    rel="noopener noreferrer">
                    <img alt="[GitHub Logo]" class="github-logo"
                        src="https://github.githubassets.com/favicons/favicon.svg"><span>Repository</span>
                </a>
            </p>
        </section>
        <section>
            <h2>Intro â€“ the why, the how and the ugly truth</h2>
            <p>
                To me, documentation by example is the best kind of documentation. As the saying goes: <i>one example is
                    worth a thousand words</i>.
                However, I was tired of my examples getting obsolete.
            </p>
            <p>
                Elixir has ExUnitâ€™s <a href="https://hexdocs.pm/ex_unit/ExUnit.DocTest.html" target="_blank"
                    rel="noreferrer noopener">DocTest</a> ; I wondered if could we have something in that fashion in the
                JS/TS ecosystem.
            </p>
            <p>
                Then I figured: why not reconcile the 2 ? Write JSDoc examples, and generate tests from themâ€¦<br>
                Plus JsDoc `@example` provide in-IDE documentation for free.<br>
            </p>
            <p>So here comesâ€¦ <b>generate-jsdoc-example-tests</b> ðŸŽ‰.</p>
        </section>

        <section>
            <h2>Demo</h2>
            <p>Letâ€™s take a date format function, for instance.</p>
            <p>1. Add the JSDoc example in the source code</p>
            <pre><code class="language-typescript">// src/date-formatter.ts
/**
 * @example
 * ```ts
 * import { formatDateYear } from './date-formatter'
 *
 * expect(formatDateYear(new Date('2026-01-01')).toBe('2026')
 * ```
 */
export function formatDateYear(date: Date): string {â€¦}</code></pre>
            <p>2. Generate the test using <code>npx gen-jet</code></p>
            <pre><code class="language-bash">npx gen-jet ./src \
    --header 'import { expect, test } from "vitest"' \
    --test-file-extension '.example.test' # do not provide the `.ts` or `.js`
    # --watch              enables watch mode</code></pre>

            <p>3. The generated test:</p>
            <pre><code class="language-typescript">// src/date-formatter.example.test.ts
// DO NOT EDIT â€¦
import { expect, test } from 'vitest' // the provided header
import { formatDateYear } from './date-formatter'

test('Example 1', () => {
  expect(formatDateYear(new Date('2026-01-01'))).toBe('2026')
})</code></pre>

        </section>

        <hr>

        <blockquote class="info alert">
            <p>Contributions are more than welcome! If anyone is interested, please <a
                    href="https://github.com/SacDeNoeuds/generate-jsdoc-example-tests/blob/main/CONTRIBUTING.md"
                    target="_blank" rel="noopener noreferrer">do get in touch</a> ðŸ˜Š (I rarely bite).
            </p>
        </blockquote>

        <hr>

        <section>
            <h2>What can you document with that ?</h2>
            <p>
                Any developer-oriented documentation, really:
            <ul>
                <li>Libraries, internal or external â€“ in conjunction with <a href="https://tsdoc.org/" target="_blank"
                        rel="noopener noreferrer">TSDoc</a> or <a href="https://typedoc.org/" target="_blank"
                        rel="noopener noreferrer">TypeDoc</a> for instance.</li>
                <li>APIs of your productâ€™s domain, for other domains to consume.</li>
            </ul>
            </p>

            <p>For now it supports functions, methods, interfaces/types & constants.</p>
            <p><b>Bonus</b>: if you have a prettier config, it uses it to format the generated test files.</p>

            <blockquote class="alert info">
                <h4>Test-Runner Agnostic</h4>
                <p>
                    To adapt the generated test files to your test runner, you can
                    override the test function and add imports using options â€“ see <a
                        href="https://github.com/SacDeNoeuds/generate-jsdoc-example-tests?tab=readme-ov-file#usage">usage</a>
                    and the <a
                        href="https://github.com/SacDeNoeuds/generate-jsdoc-example-tests?tab=readme-ov-file#vitest">Vitest
                        example</a>.
                </p>
                <h4>Why</h4>
                <p>Iâ€™d rather integrate with test runners to benefit from goodies like coverage and reports rather
                    than building my own micro test runner.</p>
            </blockquote>
        </section>

        <section>
            <h2>How I use it in my projects</h2>

            <p>
                I used it to implement yet-another schema library called <a href="https://sacdenoeuds.github.io/unhoax/"
                    target="_blank" rel="noreferrer noopener">unhoax</a> â€“ a type-driven one, you can check it out.<br>
                I managed to reach >99% of coverage just by using example tests. Bonus: The examples are re-used to
                generate the full reference.
            </p>

            <h3>Project setup</h3>
            <ul>
                <li>NPM script to generate test files</li>
                <li>NPM script to remove generated test files</li>
                <li>git-ignore the generated test files</li>
            </ul>
            <p>
                Sources files:
                <a href="https://github.com/SacDeNoeuds/unhoax/blob/main/package.json" target="_blank"
                    rel="noreferrer noopener">package.json</a> |
                <a href="https://github.com/SacDeNoeuds/unhoax/blob/main/.gitignore" target="_blank"
                    rel="noreferrer noopener">.gitignore</a>
            </p>

            <h3>In the CI</h3>
            <p>
                Generate test files <i>after</i> linting, type checking, â€¦ and <i>before</i> running the tests.<br>
                That way, I could benefit from my test runnerâ€™s coverage capabilities and generate the coverage badge.
                <br><br>
                Sources file: <a href="https://github.com/SacDeNoeuds/unhoax/blob/main/.github/workflows/coverage.yml"
                    target="_blank" rel="noreferrer noopener">.github/workflows/coverage.yml</a>
            </p>
        </section>
        <section>
            <h2>Final considerations</h2>
            <p>
                I personally enjoyed working that way. The only downside was writing code in comments, losing syntax
                checking and code completions for instance. I considered this trade-off acceptable.
            </p>
        </section>
    </main>
</body>

</html>